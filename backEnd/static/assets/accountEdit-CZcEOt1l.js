const __vite__fileDeps=["assets/index-rR4Afz6Y.js","assets/index-RLiYeSVa.js","assets/index-DBz_WDjk.css","assets/index-ClrNYZHL.js","assets/index-ByKnJqO2.js","assets/AccountConf-CFtWl7ST.js","assets/AccountConf-BSe1nQ2k.css","assets/IconSuccess-7dqyRHNn.js","assets/IconDefault-J-Toj4BP.js","assets/IconSlash-ComhJA4f.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{h as J,G as j,H as V,a as g,k as w,b as a,d as s,w as i,e as u,t as L,f as y,P as Q,F as q,A as W,N as I,g as d,_ as c,J as X,Q as Y,K as Z,S as ee,V as te}from"./index-RLiYeSVa.js";import se from"./index-BuMFAEmP.js";import{u as le}from"./AccountConf-CFtWl7ST.js";import{u as ae}from"./hy2Server-JsOFiE1I.js";import{u as oe}from"./auth-Bef3KxsT.js";import{r as ne}from"./tools-DS0odpU0.js";const m=f=>(ee("data-v-42b7528d"),f=f(),te(),f),ie={AccountEditMainBase:""},ue={AccountMainEditDiv:""},re=m(()=>a("label",null,"账户名",-1)),de=m(()=>a("label",null,"权限",-1)),ce=m(()=>a("label",null,"代理连接秘钥",-1)),me=m(()=>a("label",null,"最大在线数",-1)),ve=m(()=>a("label",null,"最大流量 单位:GB",-1)),_e=m(()=>a("br",null,null,-1)),pe={style:{display:"flex",gap:"10px","flex-wrap":"wrap"}},fe={PermissionEditDiv:""},he={ServerPermissionEditContainer:""},ye={style:{flex:"1",padding:"0.7rem 0.7rem 0.7rem 0.1rem"}},Ie=m(()=>a("div",{class:"space",style:{"min-width":"10px"}},null,-1)),Se={ServerPermissionContentDiv:"",style:{flex:"1"}},be={style:{display:"flex","justify-content":"center","margin-top":"20px"}},Ve={__name:"accountEdit",props:["targetIndex"],setup(f){const v=d(()=>c(()=>import("./index-rR4Afz6Y.js"),__vite__mapDeps([0,1,2]))),D=d(()=>c(()=>import("./index-ClrNYZHL.js"),__vite__mapDeps([3,1,2]))),z=d(()=>c(()=>import("./index-ByKnJqO2.js"),__vite__mapDeps([4,1,2]))),N=d(()=>c(()=>import("./AccountConf-CFtWl7ST.js").then(t=>t.I),__vite__mapDeps([5,1,2,6]))),O=d(()=>c(()=>import("./IconSuccess-7dqyRHNn.js"),__vite__mapDeps([7,1,2]))),T=d(()=>c(()=>import("./IconDefault-J-Toj4BP.js"),__vite__mapDeps([8,1,2]))),B=d(()=>c(()=>import("./IconSlash-ComhJA4f.js"),__vite__mapDeps([9,1,2]))),x=j(),C=f,_=le(),U=ae(),E=oe(),l=V({}),p=V([]),h=V("");l.value=JSON.parse(JSON.stringify(_.accountList.value[C.targetIndex])),p.value=U.registeredList.map(t=>l.value.userInfo.accessServer.some(e=>e==t.alias)?{...t,permission:1,show:!0}:l.value.userInfo.blockServer.some(e=>e==t.alias)?{...t,permission:-1,show:!0}:{...t,permission:0,show:!0}),h.value="";const K=t=>t?(t/125e3).toFixed(2):0,F=t=>t?Number((t.used/t.total*100).toFixed(1)):100,G=()=>l.value.userInfo.bandwidth.used=0,M=()=>l.value.userInfo.hy2Key=ne(30),k=()=>{for(let t=0;t<p.value.length;t++){const e=p.value[t];e.show=!1,(e.alias.includes(h.value)||h.value.includes(e.alias))&&(e.show=!0)}},R=t=>t.show?"serverLineShow":"serverLineHide",S=(t,e)=>{let n="defaultClass";return t=="access"&&e.permission==1?n+=" target access":t=="default"&&e.permission==0?n+=" target default":t=="block"&&e.permission==-1&&(n+=" target block"),n},b=(t,e)=>e.permission=t,$=()=>_.editorShow=!1,H=()=>{const t={target:l.value.userName,hy2Key:l.value.userInfo.hy2Key,txSpeed:parseInt(l.value.userInfo.txSpeed),maxOnline:parseInt(l.value.userInfo.maxOnline),maxBandwidth:parseFloat(l.value.userInfo.bandwidth.total),usedBandwidth:l.value.userInfo.bandwidth.used,accessServer:p.value.filter(e=>e.permission==1).map(e=>e.alias),blockServer:p.value.filter(e=>e.permission==-1).map(e=>e.alias)};X.post("/auth/edit",t).then(e=>{if(e.data.error)throw new Error("服务器拒绝");_.accountList.value[C.targetIndex]=e.data.targetAccount,x.add({severity:"success",summary:"完成",detail:e.data.msg,life:3e3}),_.editorShow=!1,_.targetIndex=-1,_.editorMode="done";const n=e.data.targetAccount;E.userName==n.userName&&E.coverUserInfo(n.userInfo)}).catch(e=>{var n,r;x.add({severity:"error",summary:"失败",detail:"服务器拒绝"+((r=(n=e==null?void 0:e.response)==null?void 0:n.data)==null?void 0:r.msg),life:5e3})})};return(t,e)=>{const n=Y,r=Z,P=se;return g(),w("div",null,[a("div",ie,[a("div",ue,[a("div",null,[s(u(v),null,{default:i(()=>[re,s(n,{size:"small",placeholder:"账户名",modelValue:l.value.userName,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.userName=o),disabled:""},null,8,["modelValue"])]),_:1})]),a("div",null,[s(u(v),null,{default:i(()=>[de,s(n,{size:"small",placeholder:"权限",modelValue:l.value.userPermission,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.userPermission=o),disabled:""},null,8,["modelValue"])]),_:1})]),a("div",null,[s(u(v),null,{default:i(()=>[ce,s(n,{size:"small",placeholder:"代理连接秘钥",modelValue:l.value.userInfo.hy2Key,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.userInfo.hy2Key=o),disabled:""},null,8,["modelValue"])]),_:1})]),a("div",null,[s(u(v),null,{default:i(()=>[a("label",null,"最大速率 ≈"+L(K(l.value.userInfo.txSpeed))+"Mb/s",1),s(n,{size:"small",type:"number",placeholder:"最大速率",modelValue:l.value.userInfo.txSpeed,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.userInfo.txSpeed=o)},null,8,["modelValue"])]),_:1})]),a("div",null,[s(u(v),null,{default:i(()=>[me,s(n,{size:"small",type:"number",placeholder:"最大在线数",modelValue:l.value.userInfo.maxOnline,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.userInfo.maxOnline=o)},null,8,["modelValue"])]),_:1})]),a("div",null,[s(u(v),null,{default:i(()=>[ve,s(n,{size:"small",type:"number",placeholder:"最大流量 单位:GB",modelValue:l.value.userInfo.bandwidth.total,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.userInfo.bandwidth.total=o)},null,8,["modelValue"])]),_:1}),_e,s(u(z),{value:F(l.value.userInfo.bandwidth)},null,8,["value"])]),a("div",pe,[s(r,{onClick:G,size:"small",severity:"secondary"},{default:i(()=>[y("清空已用量")]),_:1}),s(r,{onClick:M,size:"small",severity:"secondary"},{default:i(()=>[y("重置代理连接密码")]),_:1})])]),a("div",fe,[a("div",null,[s(P,{style:{"font-size":"80%"}},{default:i(()=>[s(n,{modelValue:h.value,"onUpdate:modelValue":e[6]||(e[6]=o=>h.value=o),onKeydown:Q(k,["enter"])},null,8,["modelValue"]),s(r,{onClick:k},{default:i(()=>[s(u(N),{style:{"font-size":"350%"}})]),_:1})]),_:1})]),a("div",he,[(g(!0),w(q,null,W(p.value,o=>(g(),w("div",{ServerPermissionEdit:"",class:I(R(o))},[a("div",ye,L(o.alias),1),Ie,a("div",Se,[s(P,{style:{height:"100%",width:"100%"}},{default:i(()=>[s(r,{size:"small",onClick:A=>b(1,o),class:I(S("access",o)),severity:"secondary"},{default:i(()=>[s(u(O))]),_:2},1032,["onClick","class"]),s(r,{size:"small",onClick:A=>b(0,o),class:I(S("default",o)),severity:"secondary"},{default:i(()=>[s(u(T))]),_:2},1032,["onClick","class"]),s(r,{size:"small",onClick:A=>b(-1,o),class:I(S("block",o)),severity:"secondary"},{default:i(()=>[s(u(B))]),_:2},1032,["onClick","class"])]),_:2},1024)])],2))),256))])])]),a("div",be,[s(r,{onClick:$,severity:"secondary"},{default:i(()=>[y("取消")]),_:1}),s(u(D),{layout:"vertical"}),s(r,{onClick:H,severity:"success"},{default:i(()=>[y("确定")]),_:1})])])}}},Pe=J(Ve,[["__scopeId","data-v-42b7528d"]]);export{Pe as default};
